<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Guess-to-Pass Probability</title>

    <style>
      :root {
        color-scheme: light dark;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.5;
      }

      body {
        margin: 0;
        background: #f7f7fb;
        color: #1f1f1f;
      }

      main {
        max-width: 720px;
        margin: 0 auto;
        padding: 32px 20px 40px;
      }

      header {
        margin-bottom: 24px;
      }

      h1 {
        margin: 0 0 8px;
        font-size: 2rem;
      }

      p {
        margin: 0;
        color: #4a4a4a;
      }

      .card {
        background: #ffffff;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 10px 30px rgba(31, 31, 31, 0.08);
      }

      .grid {
        display: grid;
        gap: 16px;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }

      label {
        display: block;
        font-weight: 600;
        margin-bottom: 6px;
      }

      input[type="number"],
      input[type="range"] {
        width: 100%;
        margin-bottom: 6px;
        padding: 8px 10px;
        border-radius: 10px;
        border: 1px solid #d2d2dc;
        font-size: 1rem;
        background: #ffffff;
      }

      .result {
        margin-top: 24px;
        padding: 16px;
        border-radius: 12px;
        background: #f0f4ff;
        border: 1px solid #c9d8ff;
      }

      .result h2 {
        margin: 0 0 8px;
        font-size: 1.25rem;
      }

      .result strong {
        font-size: 1.5rem;
        color: #1b3a8a;
      }

      .note {
        margin-top: 8px;
        font-size: 0.9rem;
        color: #5a5a5a;
      }

      footer {
        margin-top: 24px;
        font-size: 0.85rem;
        color: #6d6d6d;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background: #141722;
          color: #f5f6fa;
        }

        p {
          color: #c7cad4;
        }

        .card {
          background: #1e2233;
          box-shadow: none;
          border: 1px solid #2f3550;
        }

        input {
          background: #22263a;
          border-color: #363d59;
          color: #f5f6fa;
        }

        .result {
          background: #1b254d;
          border-color: #2b3a78;
        }

        .result strong {
          color: #8bb0ff;
        }
      }

      input[type="number"] {
  color: #1f1f1f;
  background: #ffffff;
}

@media (prefers-color-scheme: dark) {
  input[type="number"] {
    color: #f5f6fa;
    background: #22263a;
  }
}

      .grid > div {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
    </style>
  </head>

  <body>
    <main>
      <header>
        <h1>Guess-to-Pass Probability</h1>
        <p>Estimate the chance of passing a multiple-choice test by random guessing.</p>
      </header>

      <section class="card">
        <div class="grid">
          <div>
            <label>Pass score (%)</label>
            <input id="passScore" type="range" min="0" max="100" step="0.1" value="60" />
            <input id="passScoreNum" type="number" min="0" max="100" step="0.1" value="60" />
          </div>

          <div>
            <label>Number of items (n)</label>
            <input id="items" type="range" min="1" max="200" step="1" value="50" />
            <input id="itemsNum" type="number" min="1" step="1" value="50" />
          </div>

          <div>
            <label>Options per item (k)</label>
            <input id="options" type="range" min="2" max="6" step="1" value="4" />
            <input id="optionsNum" type="number" min="2" step="1" value="4" />
          </div>
        </div>

        <div class="result" aria-live="polite">
          <h2>Chance of passing by guessing</h2>
          <strong id="probability">--</strong>
          <div class="note" id="details"></div>
          <div class="note" id="assumptions"></div>
        </div>
      </section>

      <footer>
        Uses the binomial distribution with a percentage-based pass threshold.
      </footer>
    </main>

    <script>
      const passScore = document.getElementById("passScore");
      const passScoreNum = document.getElementById("passScoreNum");
      const items = document.getElementById("items");
      const itemsNum = document.getElementById("itemsNum");
      const options = document.getElementById("options");
      const optionsNum = document.getElementById("optionsNum");

      const probabilityOutput = document.getElementById("probability");
      const detailsOutput = document.getElementById("details");
      const assumptionsOutput = document.getElementById("assumptions");

      const logFactCache = [0];

      function logFactorial(n) {
        for (let i = logFactCache.length; i <= n; i++) {
          logFactCache[i] = logFactCache[i - 1] + Math.log(i);
        }
        return logFactCache[n];
      }

      function logBinomial(n, k) {
        return logFactorial(n) - logFactorial(k) - logFactorial(n - k);
      }

      function logSumExp(values) {
        const maxVal = Math.max(...values);
        let sum = 0;
        for (const v of values) sum += Math.exp(v - maxVal);
        return maxVal + Math.log(sum);
      }

      function computeProbability(pass, n, k) {
        const p = 1 / k;
        const minCorrect = Math.ceil((pass / 100) * n);
        const logs = [];
        for (let i = minCorrect; i <= n; i++) {
          logs.push(
            logBinomial(n, i) +
            i * Math.log(p) +
            (n - i) * Math.log(1 - p)
          );
        }
        return { prob: Math.exp(logSumExp(logs)), minCorrect };
      }

      function formatPercent(x) {
        return Number.isFinite(x) ? `${(x * 100).toFixed(1)}%` : "--";
      }

      function sync(a, b) {
        b.value = a.value;
        update();
      }

      function update() {
        const pass = Number(passScore.value);
        const n = Number(items.value);
        const k = Number(options.value);

        const { prob, minCorrect } = computeProbability(pass, n, k);
        probabilityOutput.textContent = formatPercent(prob);
        detailsOutput.textContent = `Need at least ${minCorrect} correct out of ${n}.`;
        assumptionsOutput.textContent = `Assumes random guessing (p = 1/${k}).`;
      }

      passScore.addEventListener("input", () => sync(passScore, passScoreNum));
      passScoreNum.addEventListener("input", () => sync(passScoreNum, passScore));
      items.addEventListener("input", () => sync(items, itemsNum));
      itemsNum.addEventListener("input", () => sync(itemsNum, items));
      options.addEventListener("input", () => sync(options, optionsNum));
      optionsNum.addEventListener("input", () => sync(optionsNum, options));

      update();
    </script>
  </body>
</html>
